<div class="container mt-3">
    <h2 class="mb-4">Update Coconut</h2>
    <form action="<%= urlPrefix %>/coconuts/update %>" method="POST">
        <div class="row">
            <div class="col-sm-8">
                <div class="row">
                    <div class="col-sm-4">
                        <input type="hidden" name="_id" value="<%= coconut._id %>" id="_id">

                        <div class="form-group">
                            <label for="title">Title</label>
                            <input type="text" name="title" id="title" class="form-control" required value="<%= coconut.title %>" >
                        </div>

                    </div>
                    <div class="col-sm-8">

                        <div class="form-group">
                            <label for="headline">Headline</label>
                            <input type="text" name="headline" id="headline" class="form-control" required value="<%= coconut.headline %>" >
                        </div>

                    </div>
                </div>

                <div class="form-group">
                    <label for="situation">Situation</label> 
                    <textarea name="situation" id="situation" rows="2" class="form-control" required><%= coconut.situation %> </textarea>
                </div>
                
                <div class="form-group">
                    <label for="task">Task</label> 
                    <textarea name="task" id="task" rows="2" class="form-control" required><%= coconut.task %> </textarea>
                </div>

                <div class="form-group">
                    <label for="aaction">Action</label> 
                    <textarea name="aaction" id="aaction" rows="2" class="form-control" required><%= coconut.aaction %> </textarea>
                </div>

                <div class="form-group">
                    <label for="rresult">Result</label> 
                    <textarea name="rresult" id="rresult" rows="2" class="form-control" required><%= coconut.rresult %> </textarea>
                </div>
                
                <div class="form-group">
                    <label for="shortDescription">Short Description</label> 
                    <textarea name="shortDescription" id="shortDescription" rows="2" class="form-control" required ><%= coconut.shortDescription %></textarea>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="llocation">Location</label>
                            <input type="text" name="llocation" id="llocation" class="form-control" value="<%= coconut.llocation %>" >
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="rrole">Role</label>
                            <input type="text" name="rrole" id="rrole" class="form-control" value="<%= coconut.rrole %>" >
                        </div>
                    </div>
                </div>

                
            </div>
            <div class="col-sm-4">

                <div class="form-group">
                    <label for="startDate">Start Date</label>
                    <input type="date" name="startDate" id="startDate" class="form-control" required value="<%= coconut.startDate %>" >
                </div>

                <div class="form-group">
                    <label for="endDate">End Date</label>
                    <input type="date" name="endDate" id="endDate" class="form-control" required value="<%= coconut.endDate %>" >
                </div>
                
                
                <div class="form-group">
                    <label for="technologies[]">Technologies</label>   
                    <select name="technologies[]" id="technologies" class="form-control" style="resize:vertical" multiple size="6">
                        <% for (t of technologies) { %>
                            <option value="<%= t.name %>" <% if (coconut.technologies.includes(t.name)) { %>selected<% } %>><%= t.name %></option>
                        <% } %> 
                    </select>
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="form-group">
                            <label for="ttime">Time (hours)</label>
                            <input type="number" name="ttime" id="ttime" max="499" step=".5" min="0" class="form-control" value="<%= coconut.ttime %>" >
                        </div>
                    </div>
                    <div class="col-6">
                        <p>Hidden</p>
                        <div class="form-check form-check-inline">
                            <input type="radio" name="hhidden" id="hiddenTrue" value="true" class="form-check-input">
                            <label for="hiddenTrue" class="form-check-label">Yes</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input type="radio" name="hhidden" id="hiddenFalse" value="false" class="form-check-input" checked>
                            <label for="hiddenFalse" class="form-check-label" >No</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="uurl">Live URL</label>
                    <input type="text" name="uurl" id="url" class="form-control" value="<%= coconut.uurl %>" >
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="form-group">
                            <label for="images">Images</label>
                            <input type="image" name="images" id="images" class="form-control" disabled>
                            <small>Image uploads disabled.</small>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label for="video">Video URL</label>
                            <input type="text" name="video" id="video" class="form-control" value="<%= coconut.video %>" >
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="ttype">Type of Project</label>
                            <input type="text" name="ttype" id="ttype" placeholder="Work Project" class="form-control" value="<%= coconut.ttype %>" >
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label for="category">Project Classification</label>
                            <input type="text" name="category" id="category" placeholder="Programming, Research, etc." class="form-control" value="<%= coconut.category %>" >
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <input type="submit" value="Submit" class="btn btn-primary">
    </form>
</div>

<!-- The Modal -->
<div class="modal" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">New Technology</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
  
        <!-- Modal body -->
        <div class="modal-body">
            <label for="techName">Name</label>
          <input type="text" name="techName" id="newTech" class="form-control">
        </div>
        <button id="newTechBtn" class="btn btn-primary">Submit</button>
      </div>
    </div>
  </div>

  <script>
      $("#newTechBtn").click(function() {
          let tech = $("#newTech").val();
          if (!tech == "") {
            $.post({
                url: "<%= urlPrefix %>/technologies",
                success: () => {
                    $("#newTechBtn").toggleClass("btn-primary");
                    $("#newTechBtn").toggleClass("btn-success");
                    $("#newTechBtn").html("Success!");
                    setTimeout(function(){
                        $('#myModal').modal('toggle');
                        $("#technologies").append(`<option value="${$("#newTech").val().replaceAll(" ", "_")}">${$("#newTech").val()}</option>`)
                    }, 2000);
                },
                error: (err) => {
                    console.log(err);
                },
                data: {"name": $("#newTech").val()}
            })
          }
      })
  </script>